(function(){var a=benignware.core.Class;var h=a.require("benignware.core.Component");var c=a.require("benignware.core.Element");var g=a.require("benignware.core.Event");var f=a.require("benignware.util.Delegate");var e=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var j=a.require("benignware.util.DOM");var d;b.setDefaultStyle(".benignware-controls-SelectableItem","cursor","pointer");b.setDefaultStyle(".benignware-controls-SelectableItem.selected","background","#3399ff");b.setDefaultStyle(".benignware-controls-SelectableItem.selected","color","#ffffff");function i(){var q=d.apply(this,arguments);var o=false;var l=true;var r=false;var k=false;function m(s){g.normalize(s);r=true;if(s.type=="mousedown"){s.preventDefault()}if(this.selectEvent=="down"){if(this.isSelectable()){this.toggleSelected()}this.dispatchEvent(g.create(this.ownerDocument,"push",false,false))}}function p(s){g.normalize(s);if(r){k=true}}function n(s){if(this.selectEvent=="up"&&r&&!k){g.normalize(s);if(s.target==this||j.isChildOf(s.target,this)){if(this.isSelectable()){this.toggleSelected()}this.dispatchEvent(g.create(this.ownerDocument,"push",false,false))}}r=false;k=false}this.toggleSelected=function(s){this.setSelected(this.isSelected()?false:true)};this.setSelectable=function(s){l=e.toBoolean(s)};this.isSelectable=function(){return l};this.setSelected=function(s){s=e.toBoolean(s);if(s!=o){o=s;if(s){this.addCSSName("selected");this.dispatchEvent(g.create(this.ownerDocument,"select",false,false))}else{this.removeCSSName("selected");this.dispatchEvent(g.create(this.ownerDocument,"unselect",false,false))}this.dispatchEvent(g.create(this.ownerDocument,"selectionchange",false,false))}};this.isSelected=function(){return o};if("ontouchstart" in window){this.addEventListener("touchstart",f.create(this,m),false);this.addEventListener("touchmove",f.create(this,p),false);c.addEventListener(this.ownerDocument,"touchend",f.create(this,n),false)}else{this.addEventListener("mousedown",f.create(this,m),false);this.addEventListener("mousemove",f.create(this,p),false);c.addEventListener(this.ownerDocument,"mouseup",f.create(this,n),false)}}a.register("benignware.controls.SelectableItem",i);a.extend(h,i);d=a.getParent(i);i.prototype.selectEvent="up";return i})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var d=a.require("benignware.core.Container");var i=a.require("benignware.core.Event");var g=a.require("benignware.util.Delegate");var b=a.require("benignware.util.CSS");var f=a.require("benignware.util.StringUtils");var e;function h(){e.apply(this,arguments)}a.register("benignware.controls.SelectableList",h);a.extend(d,h);e=a.getParent(h);h.prototype._initialize=function(){e._initialize.call(this)};h.prototype._createChildren=function(){var j=g.create(this,function(k){this.setSelectedItem(k.target)});this.addEventListener("itemadded",function(l){var k=l.item;if(k.isSelected&&k.isSelected()){this.setSelectedItem(k)}c.addEventListener(k,"select",j)});this.addEventListener("itemremoved",function(l){var k=l.item;if(this.getSelectedItem()==k){this.setSelectedItem(null)}c.removeEventListener(k,"select",j)});e._createChildren.call(this)};h.prototype.setSelectedItem=function(l){for(var j=0;j<this.size();j++){var k=this.get(j);if(k.setSelected){k.setSelected(l==k);if(k.setSelectable){k.setSelectable(!(l==k))}}}this.dispatchEvent(i.create(this.ownerDocument,"change",false,false))};h.prototype.getSelectedItem=function(){for(var j=0;j<this.size();j++){var k=this.get(j);if(k.isSelected&&k.isSelected()){return k}}};h.prototype.getSelectedIndex=function(){var l=this.getSelectedItem();for(var j=0;j<this.size();j++){var k=this.get(j);if(k==l){return j}}return -1};h.prototype._update=function(){e._update.call(this)};return h})();(function(){var a=benignware.core.Class;var k=a.require("benignware.core.Component");var c=a.require("benignware.core.Element");var j=a.require("benignware.core.Event");var f=a.require("benignware.util.Delegate");var e=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var l=a.require("benignware.controls.SelectableItem");var d;var i=a.getPath("benignware.controls.EditableItem","add.png");var h=a.getPath("benignware.controls.EditableItem","delete.png");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","cursor","pointer");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","visibility","hidden");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","width","16px");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","height","16px");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","background-repeat","no-repeat");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","background-position","center");b.setDefaultStyle(".benignware-controls-EditableItem .action-indicator","background-size","contain");b.setDefaultStyle(".benignware-controls-EditableItem.editing .action-indicator","visibility","visible");b.setDefaultStyle(".benignware-controls-EditableItem.editing .action-indicator.remove","background-image","url('"+h+"')");b.setDefaultStyle(".benignware-controls-EditableItem.editing .action-indicator.add","background-image","url('"+i+"')");b.setDefaultStyle(".benignware-controls-EditableItem.selected","color","#ffffff");function g(){var o=d.apply(this,arguments);var p=null;var n=true;var m=true;this.setEditable=function(r){r=e.toBoolean(r);if(r!=n){n=r;q.call(this);this.invalidate()}};this.isEditable=function(){return typeof n=="boolean"?n:true};this.setEditing=function(r){r=e.toBoolean(r);if(r!=m){m=r;q.call(this);this.invalidate()}};this.isEditing=function(){return typeof m=="boolean"?m:true};this.setAction=function(r){if(r!=p){if(p){c.removeCSSName(this.actionIndicatorElem,p)}p=r;q.call(this);this.invalidate()}};this.getAction=function(){return p};this.isSelectable=function(){if(this.isEditing()){return false}return o.isSelectable.call(this)};function q(){var r=this.getAction();if(r){if(this.isEditable()&&this.isEditing()){this.addCSSName("editing");c.addCSSName(this.actionIndicatorElem,r)}else{this.removeCSSName("editing");c.removeCSSName(this.actionIndicatorElem,r)}}}q.call(this)}a.register("benignware.controls.EditableItem",g);a.extend(l,g);d=a.getParent(g);g.ACTION_REMOVE="remove";g.ACTION_ADD="add";g.prototype.actionIndicatorElem=null;g.prototype._createChildren=function(){d._createChildren.apply(this,arguments);this.actionIndicatorElem=c.create(this.ownerDocument,"div");this.actionIndicatorElem.className="action-indicator";c.addEventListener(this.actionIndicatorElem,"ontouchend" in window?"touchend":"click",f.create(this,function(m){this.dispatchEvent(j.create("change",true,false))}));this.appendChild(this.actionIndicatorElem)};g.prototype.initialize=function(m){d._initialize.apply(this,arguments)};return g})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var e=a.require("benignware.core.Container");var k=a.require("benignware.core.Event");var h=a.require("benignware.util.Delegate");var b=a.require("benignware.util.CSS");var g=a.require("benignware.util.StringUtils");var i=a.require("benignware.controls.SelectableList");var f;function d(){var n=f.apply(this,arguments);var m=false;var l=true;this.setEditable=function(o){o=g.getBoolean(o);if(o!=m){m=o;j.call(this)}};this.isEditable=function(){return typeof m=="boolean"?m:true};this.setEditing=function(o){o=g.getBoolean(o);if(o!=l){l=o;j.call(this);this.invalidate()}};this.isEditing=function(){return typeof l=="boolean"?l:true}}a.register("benignware.controls.EditableList",d);a.extend(i,d);f=a.getParent(d);d.prototype._initialize=function(){f._initialize.call(this);j.call(this)};d.prototype.add=function(l){f.add.apply(this,arguments);j.call(this)};d.prototype.remove=function(l){f.remove.apply(this,arguments)};function j(){var l=false;if(this.isEditable()&&this.isEditing()){this.addCSSName("editing");l=true}else{this.removeCSSName("editing")}for(var m=0;m<this.size();m++){var n=this.get(m);if(n.setEditing){n.setEditing(l)}}}return d})();(function(){var a=benignware.core.Class;var j=a.require("benignware.core.Component");var c=a.require("benignware.core.Element");var i=a.require("benignware.core.Event");var f=a.require("benignware.util.Delegate");var e=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var g=a.require("benignware.controls.EditableItem");var d;b.setDefaultStyle(".benignware-controls-ListItem","box-sizing","border-box");b.setDefaultStyle(".benignware-controls-ListItem","-moz-box-sizing","border-box");b.setDefaultStyle(".benignware-controls-ListItem","-webkit-box-sizing","border-box");b.setDefaultStyle(".benignware-controls-ListItem","font-family","Arial");b.setDefaultStyle(".benignware-controls-ListItem","background","#fff");b.setDefaultStyle(".benignware-controls-ListItem:first-child","border-top","1px solid #aeaeae");b.setDefaultStyle(".benignware-controls-ListItem","border-bottom","1px solid #aeaeae");b.setDefaultStyle(".benignware-controls-ListItem > div","padding","2px");b.setDefaultStyle(".benignware-controls-ListItem > div","display","table-cell");b.setDefaultStyle(".benignware-controls-ListItem > div","vertical-align","middle");b.setDefaultStyle(".benignware-controls-ListItem label","font-size","16px");b.setDefaultStyle(".benignware-controls-ListItem label","font-weight","bold");b.setDefaultStyle(".benignware-controls-ListItem p","white-space","pre");b.setDefaultStyle(".benignware-controls-ListItem p","white-space","pre-wrap");b.setDefaultStyle(".benignware-controls-ListItem p","white-space","-pre-line");b.setDefaultStyle(".benignware-controls-ListItem p","white-space","-pre-wrap");b.setDefaultStyle(".benignware-controls-ListItem p","margin","0");b.setDefaultStyle(".benignware-controls-ListItem p","word-wrap","break-word");b.setDefaultStyle(".benignware-controls-ListItem","overflow","hidden");b.setDefaultStyle(".benignware-controls-ListItem img","vertical-align","middle");b.setDefaultStyle(".benignware-controls-ListItem label","vertical-align","middle");b.setDefaultStyle(".benignware-controls-ListItem.selected","background","#3399ff");b.setDefaultStyle(".benignware-controls-ListItem.selected","color","#ffffff");function h(){d.apply(this,arguments)}a.register("benignware.controls.ListItem",h);h=a.extend(g,h);d=a.getParent(h);h.prototype._createChildren=function(){d._createChildren.apply(this,arguments);this.actionIndicatorCell=this.ownerDocument.createElement("div");this.actionIndicatorCell.className="action-indicator-cell";this.appendChild(this.actionIndicatorCell);this.actionIndicatorCell.appendChild(this.actionIndicatorElem);this.imageCell=this.ownerDocument.createElement("div");this.imageCell.className="image-cell";this.appendChild(this.imageCell);this.imageElem=this.ownerDocument.createElement("img");this.imageElem.style.display="none";this.imageCell.appendChild(this.imageElem);this.contentCell=this.ownerDocument.createElement("div");this.contentCell.className="content-cell";this.appendChild(this.contentCell);this.labelElem=this.ownerDocument.createElement("label");this.labelElem.style.display="none";this.contentCell.appendChild(this.labelElem);this.textElem=this.ownerDocument.createElement("p");this.textElem.style.display="none";this.contentCell.appendChild(this.textElem)};h.prototype.setImage=function(k){if(k){this.imageElem.setAttribute("src",k);this.imageElem.style.display=""}else{this.imageElem.style.display="none"}};h.prototype.getImage=function(k){return this.imageElem.getAttribute("src")};h.prototype.setLabel=function(k){if(k){this.labelElem.innerHTML=k;this.labelElem.style.display=""}else{this.labelElem.style.display="none"}};h.prototype.getLabel=function(k){return this.labelElem.innerHTML};h.prototype.setText=function(k){if(k){this.textElem.innerHTML=k;this.textElem.style.display=""}else{this.textElem.style.display="none"}};h.prototype.getText=function(k){return this.textElem.innerHTML};return h})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var e=a.require("benignware.core.Container");var i=a.require("benignware.core.Event");var h=a.require("benignware.util.Delegate");var b=a.require("benignware.util.CSS");var g=a.require("benignware.util.StringUtils");var d=a.require("benignware.controls.EditableList");var f;function j(){f.apply(this,arguments)}a.register("benignware.controls.List",j);a.extend(d,j);f=a.getParent(j);j.prototype._initialize=function(){f._initialize.apply(this,arguments);this.addEventListener("change",h.create(this,function(k){if(k.target.getAction){var l=k.target.getAction();if(l=="remove"){this.remove(k.target)}}}))};return j})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var h=a.require("benignware.core.Event");var f=a.require("benignware.util.Delegate");var e=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var i=a.require("benignware.controls.SelectableItem");var d;b.setDefaultStyle(".benignware-controls-TabBarItem","font-size","15px");b.setDefaultStyle(".benignware-controls-TabBarItem","font-family","Arial");b.setDefaultStyle(".benignware-controls-TabBarItem","text-align","center");b.setDefaultStyle(".benignware-controls-TabBarItem","padding","0.5em");b.setDefaultStyle(".benignware-controls-TabBarItem","overflow","hidden");b.setDefaultStyle(".benignware-controls-TabBarItem","white-space","nowrap");b.setDefaultStyle(".benignware-controls-TabBarItem","text-overflow","ellipsis");b.setDefaultStyle(".benignware-controls-TabBarItem span, .benignware-controls-TabBarItem img","vertical-align","middle");b.setDefaultStyle(".benignware-controls-TabBarItem","line-height","1em");b.setDefaultStyle(".benignware-controls-TabBarItem","color","rgb(255,255,255)");b.setDefaultStyle(".benignware-controls-TabBarItem","background","rgba(240,240,240,0)");b.setDefaultStyle(".benignware-controls-TabBarItem.selected","background","rgba(240,240,240,0.3)");b.setDefaultStyle(".benignware-controls-TabBarItem.selected","color","rgb(0,255,255)");function g(k){_parent.apply(this,arguments);var j=null;this.setView=function(m){j=m;l.call(this)};this.getView=function(){return typeof(j)=="string"?this.ownerDocument.getElementById(j):j};function l(){var m=this.getView();console.log("update view",m);if(m){if(this.isSelected()){console.log("show view",m);m.show();if(m.setScrollPosition){m.setScrollPosition(0,0)}}else{console.log("hide view",m);m.hide()}}}this.addEventListener("selectionchange",f.create(this,l));this.addEventListener("push",f.create(this,l))}a.register("benignware.controls.TabBarItem",g);a.extend(i,g);_parent=a.getParent(g);g.prototype._initialize=function(j){_parent._initialize.apply(this,arguments);this.selectEvent="down"};g.prototype._createChildren=function(){_parent._createChildren.apply(this,arguments);this.imageElem=this.ownerDocument.createElement("img");this.imageElem.style.display="none";this.appendChild(this.imageElem);this.labelElem=this.ownerDocument.createElement("span");this.labelElem.style.display="none";this.appendChild(this.labelElem)};g.prototype.setImage=function(j){if(j){this.imageElem.setAttribute("src",j);this.imageElem.style.display=""}else{this.imageElem.style.display="none"}};g.prototype.getImage=function(){return this.imageElem.getAttribute()};g.prototype.setLabel=function(j){if(j){this.labelElem.innerHTML=j;this.labelElem.style.display=""}else{this.labelElem.style.display="none"}};g.prototype.getLabel=function(j){return this.labelElem.innerHTML};return g})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var k=a.require("benignware.core.Event");var g=a.require("benignware.util.Delegate");var b=a.require("benignware.util.CSS");var f=a.require("benignware.util.StringUtils");var d=a.require("benignware.core.Container");var i=a.require("benignware.controls.SelectableList");var e;b.setDefaultStyle(".benignware-controls-TabBar","background","#000");b.setDefaultStyle(".benignware-controls-TabBar","height","2em");b.setDefaultStyle(".benignware-controls-TabBar","font-size","15px");b.setDefaultStyle("ul.benignware-controls-TabBar","margin","0");b.setDefaultStyle("ul.benignware-controls-TabBar","padding","0");b.setDefaultStyle("ul.benignware-controls-TabBar","list-style-type","none");b.setDefaultStyle("ul.benignware-controls-TabBar","list-style-position","inside");function h(){e.apply(this,arguments)}a.register("benignware.controls.TabBar",h);a.extend(i,h);e=a.getParent(h);h.prototype._initialize=function(){e._initialize.apply(this,arguments);this.setLayout("horizontal-content-fit")};h.prototype._createChildren=function(){e._createChildren.apply(this,arguments);this.addEventListener("change",g.create(this,j),false)};h.prototype.add=function(m,l){e.add.apply(this,arguments);j.call(this)};function j(){}return h})();(function(){var n=benignware.core.Class;var k=n.require("benignware.core.Element");var i=n.require("benignware.core.Component");var w=n.require("benignware.core.Event");var r=n.require("benignware.util.Delegate");var x=n.require("benignware.util.StringUtils");var h=n.require("benignware.util.CSS");var s=n.require("benignware.util.DOM");var a=n.require("benignware.util.UserAgent");var d=n.require("benignware.core.Transition");var p;function o(){p.apply(this,arguments)}o.duration=0.5;o.offset={x:0,y:0};o.getByName=function(z){z=z.replace("#","");var C=document;var B=C.getElementsByTagName("a");for(var A=0;A<B.length;A++){var y=B[A];if(y.getAttribute("name")==z){return y}}return null};n.register("benignware.view.Anchor",o);n.extend(i,o);p=n.getParent(o);function j(y){var z=c(y);return z[0]}function c(A){var B=A;var y=[];while(B){var z=null;if(B.style){var C=k.getComputedStyle(B,"display");if(B.scrollTo){z=B}else{var D=k.getComputedStyle(B,"overflow");if((D=="scroll"||D=="auto")&&B.scrollHeight>0){if(B.parentNode&&B.parentNode.scrollTo&&B.parentNode.contentElem==B){}else{z=B}}}if(z){y.push(z)}}B=B.parentNode}if(y.length){return y}return[a.getInstance().firefox?A.ownerDocument.documentElement:A.ownerDocument.body]}o.prototype.duration;o.prototype.offset;o.initialize=function(B){B=B||document;var I="ontouchstart" in window?"touchstart":"mousedown";var A="ontouchmove" in window?"touchmove":"mousemove";var D="ontouchend" in window?"touchend":"mouseup";var J="click";var G=false;var H=false;var E=false;function z(K){G=true;E=false;B.addEventListener(A,C,false)}B.addEventListener(I,z,false);function C(K){if(G){H=true}}function y(O){w.normalize(O);var N=O.target;var M=N.tagName&&N.tagName.toLowerCase()=="a"?N:s.getParentByTagName(N,"a");if(M){if(H){N.addEventListener(J,F,false)}else{var L=M.getAttribute("href");if(L){var K=o.getByName(L);if(K){o.scrollTo(K);N.addEventListener(J,F,false)}else{}}}}H=false;G=false;N.removeEventListener(A,C,false)}B.addEventListener(D,y,false);function F(K){K.preventDefault();B.removeEventListener(J,F,false)}};o.initialize(document);o.prototype._initialize=function(y){p._initialize.apply(this,arguments);var z=new d();z.element=this;this.addEventListener("click",r.create(this,function(A){return}),false);this.addEventListener("click",r.create(this,function(A){return}),false)};o.getViewportElement=function(z,C){var E=k.getPosition(z);var A=k.getBorderMetrics(z,"margin","border","padding");var B=z;var D=0;while(child=s.next(B)){if(child.nodeType==1){var y=u(child);if(!y&&m(child,C)){return child}}B=child}return null};function u(z){if(z.nodeType==1){if(z.childNodes.length==0){return false}for(var y=0;y<z.childNodes.length;y++){if(z.childNodes[y].nodeType==1){return true}}}return false}function m(z,B){B=typeof B!="undefined"?B:n.instanceOf(z,o)?z.offset:o.offset;var A,y;if(!z||1!==z.nodeType){return false}y=document.documentElement;A=z.getBoundingClientRect();return(!!A&&A.bottom>B.y&&A.right>B.x&&A.top<y.clientHeight+B.y&&A.left<y.clientWidth+B.x)}function l(A){var B=A;while(B){if(B.style){var z=k.getComputedStyle(B,"position");if(z=="fixed"||z=="absolute"){return false}var C=k.getComputedStyle(B,"display");if(C=="none"){return false}var y=k.getHeight(B);if(y==0){return false}}B=B.parentNode}return true}o.getNextAnchor=function(y){var A=null;var z=y;while(A=s.next(z)){if(A.tagName&&A.tagName.toLowerCase()=="a"&&A.getAttribute("name")){return A}z=A}};o.getPreviousAnchor=function(y){var A=null;var z=y;while(A=s.previous(z)){if(A.tagName&&A.tagName.toLowerCase()=="a"&&A.getAttribute("name")){return A}z=A}};o.next=function(A,z,C,D){var B=o.getViewportElement(z,D);if(B){var y=o.getNextAnchor(B);if(y){o.scrollTo(y,C,D)}return y}};o.previous=function(A,z,C,D){var B=o.getViewportElement(z,D);if(B){var y=o.getPreviousAnchor(B);if(y){o.scrollTo(y,C,D)}return y}return null};var q=new d();function v(y){q.stop()}var e="onmousewheel" in window?"mousewheel":"DOMMouseScroll";k.addEventListener(document,e,v,false);var g="ontouchstart" in window?"touchstart":"mousedown";k.addEventListener(document,g,v,false);o.isAnchor=function(y){return y.nodeName.toLowerCase()=="a"&&y.name};var t=false;o.scrollToHash=function(z,A,B){var y=o.getByName(z);if(y){o.scrollTo(y,A,B)}return y};o.scrollTo=function(B,z,D){z=typeof z=="number"?z:n.instanceOf(B,o)?B.duration:o.duration;D=typeof D!="undefined"?D:n.instanceOf(B,o)?B.offset:o.offset;var M=c(B);if(t){}t=true;var O=0;var N=0;for(var P=0;P<M.length;P++){var K=M[P];var I=m(B,D);var G=m(K,D);var E=k.getPosition(B,K);var H=E.x-D.x;var F=E.y-D.y;H=H<0?0:H;F=F<0?0:F;var J=function(y){N++;if(O==N){var R=K.getPage?K.getPageAt(H,F):-1;if(o.isAnchor(B)){o.setHash(B.name)}t=false}K.removeEventListener("transitioncomplete",J,false);K.removeEventListener("scrollend",J,false)};var Q=z;if(!G){Q=0}if(K.scrollTo){if(K.getScrollerMethod()==benignware.view.ScrollView.SCROLLER_METHOD_POSITION){var L=K.getScrollPosition();var A=K.getClientSize();K.setScrollPosition(0,0);E=k.getPosition(B,K);K.setScrollPosition(L.x,L.y);H=E.x-D.x;F=E.y-D.y;H=H<0?0:H;F=F<0?0:F}K.addEventListener("scrollend",J,false);if(K.scrollToPage&&K.getPaging()&&K.getPageAt){var C=K.getPageAt(H,F);K.scrollToPage(C,Q)}else{K.scrollTo(H,F,Q)}if(K.isScrolling()){O++}}else{if(!q.isPlaying()||(!q.endValue||(H!=q.endValue[0]&&F!=q.endValue[1]))){if(q){q.stop()}q.addEventListener("transitioncomplete",J,false);q.element=K;q.property=["scrollLeft","scrollTop"];q.endValue=[H,F];q.duration=Q==0?Q:z;q.timingFunction="ease-in-out";O++;q.start()}}}if(O==N){if(o.isAnchor(B)){o.setHash(B.name)}t=false}};var b=null;o.setHash=function(z){var y=window.location.hash.slice(1);if(b){window.clearTimeout(b);b=null}b=window.setTimeout(function(){var E=document.body.scrollLeft;var D=document.body.scrollTop;var C=f(document);if(z!=y){window.location.hash=z;for(var A=0;A<C.length;A++){var B=C[A];B.element.scrollTop=B.scrollTop;B.element.scrollLeft=B.scrollLeft}}},100)};function f(B){var z=[];for(var A=0;A<B.childNodes.length;A++){var D=B.childNodes[A];if(D.nodeType==1){var C=k.getComputedStyle(D,"overflow");if(typeof D.scrollTop!="undefined"&&(C=="auto"||C=="scroll"||C=="hidden")){z.push({element:D,scrollTop:D.scrollTop,scrollLeft:D.scrollLeft})}if(!D.scrollTo){var y=f(D);if(y.length>0){z=z.concat(y)}}}}return z}o.removeHash=function(){var y,z,A=window.location;if("pushState" in history){history.pushState("",document.title,A.pathname+A.search)}else{y=document.body.scrollTop;z=document.body.scrollLeft;A.hash="";document.body.scrollTop=y;document.body.scrollLeft=z}};window.onhashchange=function(y){y.preventDefault();return null};k.addEventListener(window,"hashchange",function(y){y.preventDefault()},false);o.prototype._createChildren=function(){p._createChildren.apply(this,arguments)};o.prototype._update=function(){p._update.apply(this,arguments)};return o})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var n=a.require("benignware.core.Component");var m=a.require("benignware.core.Event");var h=a.require("benignware.util.Delegate");var g=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var j=a.require("benignware.layout.ItemLayout");var e;var d=a.getPath("benignware.view.ActivityView","ajax-loader.gif");var l=a.getPath("benignware.view.ActivityView","warn-icon.png");var f=a.getPath("benignware.view.ActivityView","warn-icon.png");var k=a.getPath("benignware.view.ActivityView","ok.png");b.setDefaultStyle(".benignware-view-ActivityView","position","absolute");b.setDefaultStyle(".benignware-view-ActivityView","width","100%");b.setDefaultStyle(".benignware-view-ActivityView","height","100%");b.setDefaultStyle(".benignware-view-ActivityView","z-index","1");b.setDefaultStyle(".benignware-view-ActivityView","text-align","center");b.setDefaultStyle(".benignware-view-ActivityView label","display","block");b.setDefaultStyle(".benignware-view-ActivityView.progress .feedback","background-image","url('"+d+"')");b.setDefaultStyle(".benignware-view-ActivityView.warn .feedback","background-image","url('"+l+"')");b.setDefaultStyle(".benignware-view-ActivityView.error .feedback","background-image","url('"+f+"')");b.setDefaultStyle(".benignware-view-ActivityView.ok .feedback","background-image","url('"+k+"')");b.setDefaultStyle(".benignware-view-ActivityView .feedback","background-repeat","no-repeat");b.setDefaultStyle(".benignware-view-ActivityView .feedback","background-size","contain");b.setDefaultStyle(".benignware-view-ActivityView .feedback","width","32px");b.setDefaultStyle(".benignware-view-ActivityView .feedback","height","32px");b.setDefaultStyle(".benignware-view-ActivityView label","padding","5px");function i(){e.apply(this,arguments);var o=null;this.setStatus=function(q,r){r=r||"";var p=this.getStatus();if(p){this.removeCSSName(p)}this.addCSSName(q);if(r){this.setMessage(r)}o=q;this.invalidate()};this.getStatus=function(){return o}}i.STATUS_PROGRESS="progress";i.STATUS_WARN="warn";i.STATUS_ERROR="error";i.STATUS_OK="ok";a.register("benignware.view.ActivityView",i);a.extend(n,i);e=a.getParent(i);i.prototype.feedbackElem=null;i.prototype.messageElem=null;i.prototype._initialize=function(o){e._initialize.apply(this,arguments)};i.prototype._createChildren=function(){e._createChildren.apply(this,arguments);this.messageElem=this.getElementsByTagName("label")[0];if(!this.messageElem){this.messageElem=this.ownerDocument.createElement("label");this.appendChild(this.messageElem)}c.addCSSName("message");var o=this.ownerDocument.createElement("div");o.className="feedback";this.feedbackElem=o;this.insertBefore(o,this.messageElem)};i.prototype._update=function(){e._update.call(this);this.messageElem.style.display=this.getMessage()?"":"none";var o=new j();o.element=this;o.perform()};i.prototype.setFeedbackImage=function(o){this.feedbackElem.setAttribute("src",o)};i.prototype.getFeedbackImage=function(o){return c.getComputedStyle(this.feedbackElem,"backgroundImage")};i.prototype.setMessage=function(o){var p=this.messageElem;p.innerHTML=o;this.invalidate()};i.prototype.getMessage=function(){return this.messageElem.innerHTML};return i})();(function(){var a=benignware.core.Class;var o=a.require("benignware.core.Component");var d=a.require("benignware.core.Element");var n=a.require("benignware.core.Event");var b=a.require("benignware.util.CSS");var h=a.require("benignware.util.Delegate");var m=a.require("benignware.util.ImageLoader");var k=a.require("benignware.view.ActivityView");var g;function j(){g.call(this);var q=true;var r=j.SCALE_MODE_CONTAIN;var t=j.ALIGN_CENTER;var s=j.ALIGN_CENTER;this.setUseCss=function(u){if(u!=q){q=u;this.invalidate()}};this.getUseCss=function(){return q&&b.isSupported("background-size")};this.setScaleMode=function(u){if(u!=r){r=u;this.invalidate()}};this.getScaleMode=function(){return r};this.setHorizontalAlign=function(u){if(u!=s){s=u;this.invalidate()}};this.getHorizontalAlign=function(){return s};this.setVerticalAlign=function(u){if(u!=t){t=u;this.invalidate()}};this.getVerticalAlign=function(){return t}}a.extend(o,j);g=a.getParent(j);a.register("benignware.view.ImageView",j);b.setDefaultStyle(".benignware-view-ImageView","position","relative");b.setDefaultStyle(".benignware-view-ImageView","overflow","hidden");j.ALIGN_LEFT="left";j.ALIGN_RIGHT="right";j.ALIGN_CENTER="center";j.ALIGN_TOP="top";j.ALIGN_BOTTOM="bottom";j.SCALE_MODE_STRETCH="stretch";j.SCALE_MODE_CONTAIN="contain";j.SCALE_MODE_COVER="cover";j.prototype.activityViewElem=null;j.prototype.imageElem=null;j.prototype.cssImageElem=null;j.prototype._createChildren=function(){g._createChildren.call(this);var r=d.create(k);this.activityViewElem=r;this.appendChild(this.activityViewElem);var q=this.getElementsByTagName("img")[0];if(!q){q=this.ownerDocument.createElement("img");this.appendChild(q)}d.addEventListener(q,"load",h.create(this,p),false);d.addEventListener(q,"error",h.create(this,i),false);this.imageElem=q;var s=m.getResolutionSource([q,this]);if(s){this.load(s)}};j.prototype.load=function(r){console.log("ImageView::load( ",r,")");if(r){var q=this.imageElem;q.setAttribute("src",r);if(!m.isComplete(q)){q.style.display="none";this.activityViewElem.setStatus("progress");this.activityViewElem.show()}else{console.log("is complete")}}};function p(s){console.log("loaded");var r=this;this.activityViewElem.hide();if(this.getUseCss()){e.call(this)}else{var q=r.imageElem;q.style.display="";r.invalidate()}this.addCSSName("loading");this.dispatchEvent(n.create("load",false,false));c.call(this)}function i(q){console.log("error",this.imageElem.getAttribute("src"));this.activityViewElem.setStatus("error");this.imageElem.style.visibility="hidden";this.dispatchEvent(n.create("error",false,false));c.call(this)}function c(){console.log("imageview complete");this.removeCSSName("loading");this.dispatchEvent(n.create("complete",false,false))}j.prototype._update=function(){console.log("update image view",this.getUseCss());g._update.call(this);var u=this.imageElem;if(this.getUseCss()){e.call(this);return}if(!u.getAttribute("src")||u.width===0||u.height===0){return}u.style.display="none";var q=this.clientWidth;var B=this.clientHeight;u.style.display="";if(!B){this.style.height=d.getOuterHeight(u)+"px"}if(!q){this.style.width=d.getOuterWidth(u)+"px"}q=this.clientWidth;B=this.clientHeight;if(q&&B){j.scale(u,q,B,this.getScaleMode())}var s=this.getVerticalAlign();var z=s==j.ALIGN_TOP?0:s==j.ALIGN_BOTTOM?1:0.5;var r=this.getHorizontalAlign();var v=r==j.ALIGN_LEFT?0:r==j.ALIGN_RIGHT?1:0.5;q=this.getWidth();B=this.getHeight();var t=d.getOuterWidth(u);var C=d.getOuterHeight(u);var A=(q-t)*v;var w=(B-C)*z;u.style.position="absolute";u.style.left=Math.round(A)+"px";u.style.top=Math.round(w)+"px"};function e(){var r=this.imageElem;var q=this.cssImageElem;if(this.getUseCss()){console.log("css layout");r.style.display="none";if(!q){var s=this.ownerDocument.createElement("div");q=this.appendChild(s);q.style.backgroundPosition="center center";q.style.backgroundRepeat="no-repeat";q.style.width="100%";q.style.height="100%";this.cssImageElem=q}if(r.getAttribute("src")&&r.width>0&&r.height>0){q.style.backgroundImage="url("+r.getAttribute("src")+")";q.style.backgroundSize=this.getScaleMode()}}else{r.style.display="";if(cssLayoutElem){this.removeChild(cssLayoutElem);this.cssImageElem=null}this.invalidate()}}function f(r,v,s,B,A,q){A=typeof(A)!="undefined"?A:j.SCALE_MODE_CONTAIN;if(typeof(q)=="undefined"||q==null){q=A==j.SCALE_MODE_COVER?false:true}if(typeof(q)=="string"){q=q=="false"||q=="0"?false:true}if(typeof(q)=="boolean"){q=q?{width:r,height:v}:{width:0,height:0}}if(!B){var y=r>v?r/v:r<v?v/r:1;B=s*y}var u=r/s;var t=v/B;var z,x;switch(A){case j.SCALE_MODE_CONTAIN:case j.SCALE_MODE_COVER:var C;if(A==j.SCALE_MODE_CONTAIN){C=Math.max(u,t)}else{C=Math.min(u,t)}z=r*(1/C);x=v*(1/C);break;case j.SCALE_MODE_STRETCH:z=s;x=B;break}if(q){z=z<q.width||q.width==0?z:q.width;x=x<q.height||q.height==0?x:q.height}z=Math.ceil(z);x=Math.ceil(x);return{width:z,height:x}}j.scale=function(v,u,q,t,r){v.style.width="auto";v.style.height="auto";var x=d.getOuterWidth(v);var w=d.getOuterHeight(v);if(x&&w){var s=f(x,w,u,q,t,r);v.style.width=Math.ceil(s.width)+"px";v.style.height=Math.ceil(s.height)+"px"}};function l(q){if(typeof(q.complete)!="undefined"){return q.complete===true}else{if(q.naturalHeight&&q.naturalWidth){return true}}return true}return j})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var o=a.require("benignware.core.Component");var f=a.require("benignware.core.Container");var n=a.require("benignware.core.Event");var i=a.require("benignware.util.Delegate");var h=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var k=a.require("benignware.core.Transition");var l=a.require("benignware.view.ActivityView");var j=a.require("benignware.view.ImageView");var m=a.require("benignware.util.ImageLoader");var p=a.require("benignware.util.DOM");var g;b.setDefaultStyle(".benignware-view-Slideshow","overflow","hidden");b.setDefaultStyle(".benignware-view-Slideshow","position","relative");b.setDefaultStyle(".benignware-view-Slideshow","width","420px");b.setDefaultStyle(".benignware-view-Slideshow","height","380px");b.setDefaultStyle(".benignware-view-Slideshow","-user-select","none");b.setDefaultStyle(".benignware-view-Slideshow","-moz-user-select","none");b.setDefaultStyle(".benignware-view-Slideshow","-webkit-user-select","none");b.setDefaultStyle(".benignware-view-Slideshow","-webkit-text-size-adjust","none");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","position","absolute");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","z-index","100");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","width","40px");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","height","40px");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","top","50%");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","left","50%");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView","margin","-20px");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView.error","display","none");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView.warn","display","none");b.setDefaultStyle(".benignware-view-Slideshow .benignware-view-ActivityView.overlay","background","#fff");function d(){g.apply(this,arguments);var G=this;var u=false;var z=0;var A=null;var w=new m();w.addEventListener("load",t);w.addEventListener("error",B);var r=null;var C=new k();C.startValue=["0"];C.endValue=["1"];C.property=["opacity"];C.timingFunction=["ease-in"];C.addEventListener("complete",q);var s=new k();s.timingFunction=["ease-in"];s.endValue=["0"];s.property="opacity";s.addEventListener("complete",D);var E=false;this.start=function(){if(!u){this.stop();this.setPosition(0);this.dispatchEvent(n.create(this.ownerDocument,"start",false,false));this.play()}};this.play=function(){if(!u){console.log("slideshow play");y.call(this);u=true;this.dispatchEvent(n.create(this.ownerDocument,"play",false,false))}};this.pause=function(){if(u){console.log("slideshow pause");window.clearTimeout(r);u=false;this.dispatchEvent(n.create(this.ownerDocument,"pause",false,false))}};this.stop=function(){if(!u){window.clearTimeout(r);u=false;this.dispatchEvent(n.create(this.ownerDocument,"stop",false,false))}};this.togglePlay=function(){if(this.isPlaying()){this.pause()}else{this.play()}};this.setPosition=function(H){if(z!=H||!A){var I=this.get(H);z=H;var J=n.create(this.ownerDocument,"position",false,false);this.dispatchEvent(J);x.call(this)}};this.getPosition=function(){return z};this.getContentSize=function(){return{width:this.clientWidth,height:this.clientHeight}};this.getLayout=function(){return null};this.isPlaying=function(){return u};function y(){v.call(this);var H=parseFloat(G.duration)*1000;r=window.setTimeout(function(){if(G.isPlaying()){E=true;G.next();E=false}},H)}function v(){window.clearTimeout(r)}function q(H){x.call(G);F.call(G)}function F(){console.log("transition in complete");if(G.isPlaying()){y.call(G)}var J=G.getPosition();var H=J<G.size()-1?J+1:0;var I=J>0?J-1:G.size()-1;w.add(G.get(H));w.add(G.get(I));G.invalidate()}function D(H){x.call(G)}function t(I){console.log("image load handler",I.element);var H=G.get(G.getPosition());if(H==I.element){console.log("call slide item after load ",H);x.call(G)}}function B(I){console.log("image error handler",I.element);var H=G.get(G.getPosition());if(H==I.element){G.next()}}function x(){v.call(this);var N=this.getPosition();var L=this.get(this.getPosition());if(L!=null&&L!=A){var J=m.isComplete(L);if(!J){this.activityView.setStatus("progress");L.style.visibility="hidden";if(!E){this.activityView.show();if(A){this.activityView.addCSSName("overlay")}else{this.activityView.removeCSSName("overlay")}w.add(L)}}else{if(!C.isPlaying()&&!s.isPlaying()){for(var K=0;K<G.size();K++){var M=G.get(K);var I=c.getComputedStyle(M,"visiblility");if((M==L||M==A)){M.style.visibility="visible"}else{M.style.visibility="hidden";L.style.zIndex=""}}G.activityView.hide();L.style.zIndex="1";if(A){console.log("reset old item",A.style.zIndex);A.style.zIndex=""}if(A){console.log("start transition in",L.style.zIndex);C.element=L;C.duration=this.transitionDuration;C.start()}else{console.log("first item complete");F.call(this)}A=L;var H=n.create(this.ownerDocument,"slide",false,false);this.dispatchEvent(H);this.invalidate()}else{console.log("transition playing")}}}}}a.register("benignware.view.Slideshow",d);a.extend(f,d);g=a.getParent(d);d.prototype.activityView=null;d.prototype.autoPlay=true;d.prototype._initialize=function(q){g._initialize.apply(this,arguments);if(h.toBoolean(this.autoPlay)){this.start()}else{this.setPosition(0)}};d.prototype._createChildren=function(){g._createChildren.apply(this,arguments);this.activityView=c.create(this.ownerDocument,l);this.activityView.hide();this.appendChild(this.activityView)};d.prototype.duration=3;d.prototype.transitionDuration=1;d.prototype.scaleMode="contain";d.prototype._update=function(){for(var q=0;q<this.size();q++){var r=this.get(q);e.call(this,r)}};function e(u){var t=Math.round(this.getWidth());var s=Math.round(this.getHeight());u.style.position="absolute";var q=p.getDeepestElement(u);var r=p.getParentByClass(q,o);if(q.tagName.toLowerCase()=="img"&&!(r&&p.isChildOf(r,this))){elem=q;j.scale(u,t,s,this.scaleMode,null)}else{c.setWidth(elem,t);c.setHeight(elem,s)}u.style.left=Math.floor((t-c.getOuterWidth(u))*0.5)+"px";u.style.top=Math.floor((s-c.getOuterHeight(u))*0.5)+"px"}d.prototype.next=function(){var q=this.getPosition();if(q+1<this.size()){q++}else{q=0}this.setPosition(q)};d.prototype.previous=function(){var q=this.getPosition();if(q-1>=0){q--}else{q=this.size()-1}this.setPosition(q)};return d})();(function(){var a=benignware.core.Class;var c=a.require("benignware.core.Element");var j=a.require("benignware.core.Event");var d=a.require("benignware.core.Container");var h=a.require("benignware.core.Transition");var f=a.require("benignware.util.Delegate");var e=a.require("benignware.util.StringUtils");var b=a.require("benignware.util.CSS");var i=a.require("benignware.core.Layout");var g=a.require("benignware.layout.ClientFitLayout");b.setDefaultStyle(".benignware-view-ScrollView","overflow","hidden");b.setDefaultStyle(".benignware-view-ScrollView","height","240px");b.setDefaultStyle(".benignware-view-ScrollView .content-layer","height","100%");a.create("benignware.view.ScrollView",(function(){var k;var r=b.getVendorStyle("transform");function u(v){return v<0?-v:v}function l(C,w,A,v){var z=2.5,B=1.2,x=Math.abs(C)/w*1000,y=x*x/z/1000,D=0;if(C>0&&y>A){x=x*A/y/z;y=A}else{if(C<0&&y>v){x=x*v/y/z;y=v}}y=y*(C<0?-1:1);D=x/B;return{dist:Math.round(y),time:Math.round(D)}}function m(){var aj=k.apply(this,arguments);var I=null;var ak=new h();ak.addEventListener("complete",D);var x=0;var aa=null;var Y=null;var af=0;var ab=null;var A=null;var O=null;var S={};var z;var M=this;var ah={x:0,y:0};var J=null;var ag=true;var M=this;function G(){var al=this.getPages();console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",al);var an=s.call(this,this.getScrollPosition());if(al>0){if(an!=x){x=an;var am=j.create(M.ownerDocument,"page",false,false);if(ag=="auto"&&!J){J=window.setTimeout(function(){p.call(M);J=null;M.dispatchEvent(am)},1)}else{M.dispatchEvent(am)}}}}function X(am){am=typeof(am)=="number"?am:0.25;var al=this.getScrollPosition();var an=o.call(this,al.x,al.y);if(an.x!=al.x||an.y!=al.y){console.log("scroll to bounds");this.scrollTo(an.x,an.y,am)}else{console.log("scroll finish");G.call(M);B.call(this)}}function P(al){aa=Y={x:al.changedTouches[0].clientX,y:al.changedTouches[0].clientY};af=new Date().getTime();ab=null;ac.call(this,al)}function R(ap){var an=ap.touches[0].clientX;var al=ap.touches[0].clientY;if(Y!=null){var ao=(an-Y.x)*-1;var am=(al-Y.y)*-1;Y={x:an,y:al};F.call(this,ap,ao,am)}}function E(an){if(aa!=null&&Y!=null){var am=Y.x-aa.x;var al=Y.y-aa.y;N.call(this,an,am,al);Y=aa=null}}function U(al){var am={x:al.clientX,y:al.clientY};aa=Y=am;af=new Date().getTime();ab=null;ac.call(this,al);al.preventDefault()}function K(ap){if(Y){var an=ap.clientX;var al=ap.clientY;var ao=(an-Y.x)*-1;var am=(al-Y.y)*-1;Y={x:an,y:al};F.call(this,ap,ao,am)}}function w(an){if(Y&&(Y.x!=aa.x||Y.y!=aa.y)){var am=Y.x-aa.x;var al=Y.y-aa.y;N.call(this,an,am,al)}Y=aa=null}function V(al){if(al.relatedTarget==null){A=null;if(Y!=null){E.call(this,al)}}}function y(aE){var ap=this.getScrollerMethod();var al=this.getContentSize();var an=this.getClientSize();var av=this.getScrollPosition(this);var aB=this.getScrollSize();var ax=aB.width;var aH=aB.height;var aD;var aC;if("wheelDeltaX" in aE){aD=aE.wheelDeltaX;aC=aE.wheelDeltaY}else{if("detail" in aE){if(aE.axis===2){aC=-aE.detail*12;aD=0}else{aD=-aE.detail*12;aC=0}}else{if("wheelDelta" in aE){aD=0;aC=aE.wheelDelta}}}var at=-aD/12;var ar=-aC/12;if(!this.getPaging()&&ap==m.SCROLLER_METHOD_OVERFLOW){if(!aE.axis&&!aE.wheelDeltaX){aE.stopPropagation()}return}if(!O){O={x:0,y:0};S={x:0,y:0};af=new Date().getTime();aa=av;ab={x:at,y:ar}}O.x+=at;O.y+=ar;var au={x:at,y:ar};var ay=(u(au.x)>u(au.y));if(ax>0&&aH>0||ax>0&&au.x!=0&&ay||aH>0&&au.y!=0&&!ay){aE.stopPropagation();if(ap!=m.SCROLLER_METHOD_OVERFLOW){aE.preventDefault()}var am=new Date().getTime();if(this.getPaging()){var ao=Math.sqrt(at*at+ar*ar);var aA=1;at*=50;ar*=50;var aG=av.x+at;var aF=av.y+ar;if(at>0){aG+=an.width}else{if(at<0){aG-=an.width}}var az=o.call(this,aG,aF);var aw=s.call(this,aG,aF);if(az.x!=av.x||az.y!=av.y){var aq=(am-af)*5;aq=Math.min(aq,249);N.call(this,aE,-at,-ar,aa,aq)}}else{F.call(this,aE,at,ar)}var aI=this;window.clearTimeout(z);z=window.setTimeout(function(){O=null;ab=null;aa=null;if(!ak.isPlaying()){L.call(this);B.call(aI)}},1);af=am;var ax=al.width-an.width;var aH=al.height-an.height;if(at!=0&&ax>0||ar!=0&&aH>0){}}}function ac(al){O=null;ab=null;B.call(this);ak.stop();ah=T.call(this)}function F(al,aB,ay){if(aB!=0||ay!=0){if(ab==null){ab={x:aB,y:ay}}var az=this.getScrollPosition();var av=az.x;var au=az.y;var aA=this.getScrollSize();var aw=aA.width;var ao=aA.height;var aq=0;if(e.toBoolean(this.bounces)){aq=al.type!="mousewheel"&&al.type!="DOMMouseScroll"?parseFloat(this.bounceDistance):0}var ap=av;var an=au;var ax=ab;var am=(u(ax.x)>u(ax.y));if(aw>0&&ao>0||aw>0&&ax.x!=0&&am||ao>0&&ax.y!=0&&!am){if(aw>0){ap=av+aB;var at=aq;if(ap<-at){ap=-at}else{if(ap>aw+at){ap=aw+at}}}if(ao>0){an=au+ay;var ar=aq;if(an<-ar){an=-ar}else{if(an>ao+ar){an=ao+ar}}}if(ap!=av||an!=au){ai.call(this);H.call(this);if(!q.call(this)){this.setScrollPosition(ap,an);al.preventDefault()}}}}}function N(aX,ap,an,aM,aH){var ao=250;var aN=0.25;var aL=0.25;aH=aH?aH:new Date().getTime()-af;var aU=ap;var aT=an;var am=this.getClientSize();var al=am.width;var aw=am.height;var aE=this.getContentSize();var aD=aE.width;var aF=aE.height;var ay=aD-al;var aB=aF-aw;var aV=aX.type!="mousewheel"&&aX.type!="DOMMouseScroll"?parseFloat(this.bounceDistance):0;var aI=e.toBoolean(this.bounces);var aC=this.getPaging();var aO=aC;var aG=aC;aM=aM?aM:this.getScrollPosition();var ax=aM.x;var av=aM.y;var aS=o.call(this,aM.x,aM.y);var aR=aS.x;var aP=aS.y;var aK=ab;if(aK){var aQ=(u(aK.x)>u(aK.y));if(ay>0&&aB>0||ay>0&&aK.x!=0&&aQ||aB>0&&aK.y!=0&&!aQ){if(ay>0&&aU!=0){if(aM.x<0||aM.x>ay){aR=aM.x<0?0:ay}else{if(aH>0&&aH<ao){var aA,az;if(aO){var au=Math.floor(aM.x/al)*al;aA=au-al<0?0:aM.x==au?au-al:au;az=au+al>ay?ay:au+al}else{aA=0;az=ay}maxDistX1=aM.x-aA;maxDistX2=az-aM.x;maxDistX1+=aI&&aA>0?aV:0;maxDistX2+=aI&&az<ay?aV:0;var ar=l(aU,aH,maxDistX1,maxDistX2);aN=Math.max(ar.time/1000,0.25);aR=aM.x-ar.dist;if(aO){if(aU>0&&aR>aA){aR=aA}else{if(aU<0&&aR<az){aR=az}}}}}}if(aB>0){if(aM.y<0||aM.y>aB){aP=aM.y<0?0:aB}else{if(aH>0&&aH<ao){var aY,aW;if(aG){var at=Math.floor(aM.y/aw)*aw;aY=at-aw<0?0:aM.y==at?at-aw:at;aW=at+aw>aB?aB:at+aw}else{aY=0;aW=aB}maxDistY1=aM.y-aY;maxDistY2=aW-aM.y;maxDistY1+=aI&&aY>0?aV:0;maxDistY2+=aI&&aW<aB?aV:0;var aq=l(aT,aH,maxDistY1,maxDistY2);aL=Math.max(aq.time/1000,0.25);aP=aM.y-aq.dist;if(aG){if(aT>0&&aP>aY){aP=aY}else{if(aT<0&&aP<aW){aP=aW}}}}}}}}if(aR!=ax||aP!=av){if(!q.call(this)){this.scrollTo(aR,aP,Math.max(aN,aL));aX.preventDefault()}}if(typeof"touchstart" in window=="undefined"){if(aU!=0||aT!=0){var aJ=aX.type=="touchend"?document.elementFromPoint(aa.x,aa.y):aX.target;if((aJ==this||DOM.isChildOf(aJ,this))){}}}L()}function D(al){ah=T.call(M);X.call(M)}function Q(al){if(this.getPaging()){var am=this.getPage();var an=t.call(this,am);this.setScrollPosition(an.x,an.y)}}var Z=false;this.setPaging=function(al){al=e.toBoolean(al);if(al!=Z){Z=al;n.call(this);this.invalidate()}};this.getPaging=function(){return Z};this.getLayout=function(){var al=aj.getLayout();if(this.getPaging()&&!al){al=new g();al.orientation=i.ORIENTATION_HORIZONTAL;al.element=this}return al};this.setScrollerMethod=function(am){console.log("set scroller method",am);if(am!=I){var al=this.getScrollPosition();I=am;n.call(this);this.setScrollPosition(al.x,al.y)}};this.getScrollerMethod=function(){if(I){return I}return m.SCROLLER_METHOD_OVERFLOW};this.setScrollPosition=function(al,am){C.call(this,al,am);G.call(this)};function C(al,ap){ah.x=al;ah.y=ap;ak.stop();var ao=this.getScrollerMethod();switch(ao){case m.SCROLLER_METHOD_OVERFLOW:this.contentElem.scrollLeft=al;this.contentElem.scrollTop=ap;break;case m.SCROLLER_METHOD_POSITION:this.contentElem.style.left=-al+"px";this.contentElem.style.top=-ap+"px";break;case m.SCROLLER_METHOD_TRANSFORM:case m.SCROLLER_METHOD_TRANSFORM_3D:var am=ao==m.SCROLLER_METHOD_TRANSFORM_3D;var an=am?"translate3d("+(-al)+"px, "+(-ap)+"px, 0)":"translate("+(-al)+"px, "+(-ap)+"px)";this.contentElem.style[r]=an;break}B.call(this)}this.setDisplayManagement=function(al){if(al!=ag){ag=al;p.call(this)}};this.getDisplayManagement=function(){return ag};function T(){var al=0;var ap=0;var ao=this.getScrollerMethod();switch(ao){case m.SCROLLER_METHOD_OVERFLOW:al=this.contentElem.scrollLeft;ap=this.contentElem.scrollTop;break;case m.SCROLLER_METHOD_TRANSFORM:case m.SCROLLER_METHOD_TRANSFORM_3D:var an=c.getComputedStyle(this.contentElem,r);var am=b.getTransformMatrix(an);if(am){al=-am.x;ap=-am.y}break;case m.SCROLLER_METHOD_POSITION:al=-parseInt(c.getComputedStyle(this.contentElem,"left"));ap=-parseInt(c.getComputedStyle(this.contentElem,"top"));break;default:al=ap=0}al=isNaN(al)?0:al;ap=isNaN(ap)?0:ap;return{x:Math.floor(al),y:Math.floor(ap)}}this.getScrollPosition=function(){return T.call(this)};this.scrollTo=function(aw,au,am){console.log("scroll to: ",aw,au,this.getPaging(),this.getScrollerMethod());am=typeof am!="undefined"?am:0.5;var ax=this.getScrollPosition();var ap=this.getContentSize();aw=Math.floor(aw);au=Math.floor(au);if(aw!=ax.x||au!=ax.y){if(am<=0){this.setScrollPosition(aw,au)}else{var at=[];var al=[],av=[];var ao=this.getScrollerMethod();switch(ao){case m.SCROLLER_METHOD_OVERFLOW:if(aw!=ax.x){at.push("scrollLeft");al.push(ax.x);av.push(aw)}if(au!=ax.y){at.push("scrollTop");al.push(ax.y);av.push(au)}break;case m.SCROLLER_METHOD_TRANSFORM:case m.SCROLLER_METHOD_TRANSFORM_3D:at=[r];var an=ao==m.SCROLLER_METHOD_TRANSFORM_3D;var ar=an?"translate3d("+(-ax.x)+"px, "+(-ax.y)+"px, 0)":"translate("+(-ax.x)+"px, "+(-ax.y)+"px)";al=[ar];var aq=an?"translate3d("+(-aw)+"px, "+(-au)+"px, 0)":"translate("+(-aw)+"px, "+(-au)+"px)";av=[aq];break;case m.SCROLLER_METHOD_POSITION:if(aw!=ax.x){at.push("left");al.push(-ax.x+"px");av.push(-aw+"px")}if(au!=ax.y){at.push("top");al.push(-ax.y+"px");av.push(-au+"px")}break}if(!ak.element){ak.element=this.contentElem}ak.timingFunction="ease-out";ak.property=at;ak.startValue=al;ak.endValue=av;ak.duration=am;ak.start();H.call(this)}}};var v=false;function H(){if(!v){v=true}}function B(){if(v){v=false;this.dispatchEvent(j.create("scrollend",false,false))}}this.isScrolling=function(){return v};var ae=false;var W=null;function ai(){window.clearTimeout(W);W=null;if(!M.isInteractive()){ae=true}}function L(){if(!W){W=window.setTimeout(function(){if(M.isInteractive()){W=null;ae=false}},0)}}this.isInteractive=function(){return ae};this.getPage=function(){if(ak.isPlaying()){return s.call(this,this.getScrollPosition())}return x||1};this.setPage=function(al){this.scrollToPage(al,0)};this.getPageAt=function(al,am){return s.call(this,{x:al,y:am})};if("ontouchstart" in window){this.addEventListener("touchstart",f.create(this,P),false);this.addEventListener("touchmove",f.create(this,R),false);c.addEventListener(this.ownerDocument,"touchend",f.create(this,E),false)}else{c.addEventListener(this,"mousedown",f.create(this,U),false);c.addEventListener(this.ownerDocument,"mouseup",f.create(this,w),false);c.addEventListener(this,"mousemove",f.create(this,K),false);c.addEventListener(this.ownerDocument,"mouseout",f.create(this,V),false);var ad="onmousewheel" in window?"mousewheel":"DOMMouseScroll";c.addEventListener(this,ad,f.create(this,y),false)}c.addEventListener(window,"resize",f.create(this,Q),false)}a.extend(d,m);k=a.getParent(m);m.SCROLLER_METHOD_POSITION="position";m.SCROLLER_METHOD_TRANSFORM="transform";m.SCROLLER_METHOD_TRANSFORM_3D="transform3d";m.SCROLLER_METHOD_OVERFLOW="overflow";function n(){this.contentElem.style.position="relative";var v=this.getScrollerMethod();switch(v){case m.SCROLLER_METHOD_OVERFLOW:this.contentElem.style.WebkitOverflowScrolling="touch";this.contentElem.style.overflow="auto";this.contentElem.style.minWidth="";this.contentElem.style.minHeight="";this.contentElem.style.width="100%";this.contentElem.style.height="100%";break;default:this.contentElem.style.overflow="visible";this.contentElem.style.minWidth="";this.contentElem.style.minHeight="";this.contentElem.style.width="100%";this.contentElem.style.height="100%";break}}function q(){var x=this.getScrollerMethod();if(x==m.SCROLLER_METHOD_OVERFLOW){if(!this.getPaging()){var w=b.getVendorStyle("overflow-scrolling",true);if(w){var v=c.getComputedStyle(this.contentElem,w);return v=="touch"}}}return false}function s(w){if(w.x==0&&w.y==0){return 1}var G=o.call(this,w.x,w.y);var C,z,y,v,B,F,x,E;var A=this.getContentSize();y=A.width;v=A.height;var D=this.getClientSize();C=D.width;z=D.height;if(C>0&&z>0&&(y>C||v>z)){if(y<=C){return Math.floor(G.y/z)+1}else{if(v<=z){return Math.floor(G.x/C)+1}else{B=Math.ceil(y/C);F=Math.ceil(v/z);x=Math.floor(G.x/C);E=Math.floor(G.y/z);w=E*B+x+1}}return w}return 1}function t(B){if(B<=1){return{x:0,y:0}}var I=this.getClientSize();var G=I.width;var z=I.height;var A=this.getContentSize();var w=A.width;var v=A.height;sw=w-G;sh=v-z;if(B>this.getPages()){return{x:sw,y:sh}}var D=Math.ceil(w/G);var H=(B-1)%D;var F=Math.floor((B-1)/D);var E=H*G;var C=F*z;E=E<sw?E:sw;C=C<sh?C:sh;E=E<0?0:E;C=C<0?0:C;return{x:Math.floor(E),y:Math.floor(C)}}function o(D,B){var z=D;var y=B;var v=this.getPaging();var H=this.getClientSize();var E=H.width;var w=H.height;var A=this.getContentSize();var G=A.width-E;var x=A.height-w;if(v){var F=Math.floor(D/E)*E;z=D-F>=F+E-D?F+E:F;var C=Math.floor(B/w)*w;y=B-C>=C+w-B?C+w:C}z=z<=0?0:z>G?G:z;y=y<=0?0:y>x?x:y;return{x:z,y:y}}function p(){var z=this.getDisplayManagement();if(z=="auto"&&this.getPaging()){console.log("update displayed items");var v=this.getPage()-1;var D=this.getScrollPosition();var C=this.getClientSize();var E=this.getScrollSize();for(var x=0;x<this.size();x++){var B=this.get(x);if(B.style){var A=c.getWidth(B);var y=c.getHeight(B);if(x>v-2&&x<v+2){B.style.display=""}else{B.style.display="none"}}}}else{for(var x=0;x<this.size();x++){var B=this.get(x);if(B.style){B.style.display=""}}}}m.prototype.bounceDistance=30;m.prototype.bounces=false;m.prototype._createChildren=function(){k._createChildren.apply(this,arguments)};m.prototype._initialize=function(){k._initialize.apply(this,arguments);n.call(this)};m.prototype._update=function(){k._update.apply(this,arguments);this.contentElem.style.WebkitBoxSizing="border-box";this.contentElem.style.MozBoxSizing="border-box";p.call(this)};m.prototype.getScrollSize=function(){var w=this.getClientSize();var y=this.getContentSize();var v=y.width-w.width;var x=y.height-w.height;v=v>0?v:0;x=x>0?x:0;return{width:v,height:x}};m.prototype.getPages=function(){var z=this.getScrollPosition();var y=this.getContentSize();var v=this.getClientSize();var x=Math.ceil(y.width/v.width);var w=Math.ceil(y.height/v.height);return x*w};m.prototype.scrollToPage=function(x,z){var w=this.getPage();console.log("scroll to page: ",x,", current: ",w,z);var A=z>=0?z:0.25;var y=t.call(this,x);var v=this.getScrollPosition();if(y.x!=v.x||y.y!=v.y){if(A==0){this.setScrollPosition(y.x,y.y)}else{if(Math.abs(x-w)==1){console.log("page is next, animate: ",x,A,y.x,y.y);this.scrollTo(y.x,y.y,A)}else{console.log("page is not next, not animate: ",x,A);this.setScrollPosition(y.x,y.y)}}}};return m})())})();(function(){var b=benignware.core.Class;var j=b.require("benignware.core.Event");var c=b.require("benignware.core.Element");var d=b.require("benignware.util.StringUtils");var a=b.require("benignware.core.Loader");var i=b.require("benignware.util.ImageLoader");var g=b.require("benignware.view.ActivityView");var e=b.require("benignware.view.ScrollView");var f;var h=b("benignware.view.WebView",(function(){var n;function m(){var t=n.apply(this,arguments);var u=this;var s=false;this.getPageWrap=function(){return s};this.setPageWrap=function(v){v=d.toBoolean(v);if(v!=s){s=v;this.invalidate()}};this.getPageWrap=function(){return s};var p=new a();var o=new i();this.complete=true;u.addEventListener("itemadded",function(v){o.add(v.item)});u.addEventListener("itemremoved",function(v){o.remove(v.item)});o.onloadstart=function(v){u.contentElem.style.display="none";var w=u.activityView;w.setStatus(g.STATUS_PROGRESS,u.loadingText);w.show()};o.oncomplete=function(v){var w=u.activityView;if(p.complete){q.call(u)}};function q(){var v=this.activityView;v.hide();this.contentElem.style.display="";this.invalidate();this.complete=true;this.dispatchEvent(j.create(this.ownerDocument,"complete",false,false));this.dispatchEvent(j.create(this.ownerDocument,"contentcomplete",false,false))}function r(){var v=this.activityView;v.setStatus(g.STATUS_ERROR,this.errorText);this.complete=true;this.dispatchEvent(j.create(this.ownerDocument,"complete",false,false));this.dispatchEvent(j.create(this.ownerDocument,"contentcomplete",false,false))}this.load=function(y,x){var z=u.activityView;x=x||{};var v=x.success;var w=x.error;x.type=x.type||a.TYPE_HTML;x.success=function(B){var A=B.data.body.innerHTML;var C=B.data.body.className;u.addCSSName(C);u.setHtml(A);if(o.isComplete()){q.call(u)}if(v){v(B)}};x.error=function(A){r.call(u);if(w){w(A)}};this.complete=false;this.contentElem.style.display="none";z.setStatus(g.STATUS_PROGRESS,u.loadingText);z.show();p.load(y,x);return p}}b.extend(e,m);n=b.getParent(m);m.prototype.activityView=null;function l(){for(var o=0;o<this.size();o++){var p=this.get(o);if(p.nodeType==1){if(!b.instanceOf(p,e)){c.initialize(p,e);console.log("set scroll method: ",p.getScrollerMethod())}p.style.width="100%";p.style.height="100%"}}}m.prototype._initialize=function(){n._initialize.apply(this,arguments);this.setDisplayManagement(false)};m.prototype._createChildren=function(){n._createChildren.apply(this,arguments);var o=c.create(this.ownerDocument,g);o.hide();this.appendChild(o);this.activityView=o};m.prototype._update=function(){if(this.getPageWrap()){k.call(this)}else{l.call(this)}n._update.apply(this,arguments);this.activityView.invalidate()};m.prototype.loadingText="Loading...";m.prototype.errorText="An error occured.";m.prototype._pageWrapObject=null;m.prototype.add=function(p,o){if(this._pageWrapObject){this._pageWrapObject.restore()}n.add.call(this,p,o)};function k(){var r=this.getPageWrap();var u=this._pageWrapObject;var q=this.getClientSize();var v=q.width;var p=q.height;var t=this.getLayout();if(r==true){if(!u){this._pageWrapObject=u=new f(this.contentElem)}u.pageWidth=v;u.pageHeight=p;var o=u.update();if(o.length>0){for(var s=0;s<o.length;s++){this.contentElem.appendChild(o[s])}this.contentElem.className=""}}else{if(u){u.restore()}}}return m})());f=(function(){var A=benignware.core.Element;function F(L){this.content=L;this.pages=[]}F.prototype.content=null;F.prototype.pages;F.prototype.pageWidth=0;F.prototype.pageHeight=0;F.prototype.originalItems=null;var K;var E;var n;var q;var G;var C;var I;var u;var v;var B;var s;var n=0;var t=null;var D={header:"always"};var x={header:"never"};var r={header:"never"};F.MIN_PAGE_HEIGHT=100;function w(N,L){N.innerHTML="";for(var M=0;M<L.length;M++){var P=L[M];var O=P.node;if(O.nodeType==1){if(O.__originalStyleHeight){O.style.height=O.__originalStyleHeight;delete O.__originalStyleHeight}if(O.__originalElement){delete O.__originalElement}w(O,P.children)}else{if(O.nodeType==3){O.nodeValue=P.value}}N.appendChild(O)}}F.prototype.restore=function(){console.log("****** RESTORE",this.content.parentNode);if(!this.originalItems){return}this.content.innerHTML="";w(this.content,this.originalItems);this.originalItems=null};function m(N,P){var L=[];for(var M=0;M<N.childNodes.length;M++){var Q=N.childNodes[M];var O={node:Q};if(Q.nodeType==1){O.children=P?m(Q,P):[]}else{if(Q.nodeType==3){O.value=Q.nodeValue.toString()}}L.push(O)}return L}var l=0;var k=false;function p(){if(k){var M=C.cloneNode(false);M.__originalNode=C;M.removeAttribute("id");var N=A.getBorderMetrics(M,"padding");M.style.width=I+"px";M.style.height=u+"px";M.style.overflow="";for(var L=0;L<C.childNodes.length;L++){M.appendChild(C.childNodes[L--])}v.push(M);k=false;E=M}}function z(){console.log("CREATE PAGE!!!!!!!!!!!!",K);var N=[];if(K){var M=K;while(M&&M!=C){N.push(M);M=M.parentNode}}p();k=true;K=C;for(var L=N.length-1;L>=0;L--){var O=N[L].cloneNode(false);O.__originalNode=N[L];K.appendChild(O);K=O}n=0;return K}function y(R,M){var V=[];for(var S=0;S<R.childNodes.length;S++){var P=R.childNodes[S];V.push(P)}R.innerHTML="";var U=0;var O=null;for(var S=0;S<V.length;S++){var P=V[S];var N=contentPadding;var T=A.getOuterHeight(C)-N.top-N.bottom;var Q=false;if(P.nodeType==3&&!d.trim(P.nodeValue)){continue}if(P.nodeType==1){if(D[P.nodeName.toLowerCase()]=="always"){if(C.childNodes.length>0){var W=DOM.getDeepestFirstChild(C);if(W&&W!=K){z()}}}else{for(var X in D){var L=P.getElementsByTagName(X);if(L.length){Q=true}}}}K.appendChild(P);if(!Q){var Z=C.scrollHeight-N.top-N.bottom;console.log("PROCESS CHILD: ",M,S," >> ",P,"HEIGHT: ",Z,"PAGE HEIGHT: ",u);if(Z>u){console.log("BREAK AT ",P);Q=true}if(Z==u){z();continue}}if(Q){if(P.nodeType==1){var Y=P;if(P.nodeName.toLowerCase()=="img"||P.nodeName.toLowerCase()=="iframe"){}else{if(P.nodeName.toLowerCase()=="br"){}else{K=P;y(P,M+1)}}}else{if(P.nodeType==3){console.time("PROCESS TEXT");H(P)}}}else{if(P.nodeType==1||P.nodeType==3){O=P;U=S}}}if(M>0){K=K.parentNode}}function J(N){K.removeChild(N);var M=contentPadding;var Q=N.nodeValue.split(/\s+/);var O=document.createTextNode("");O.__originalNode=N;K.appendChild(O);var T="";var P=0;for(var S=0;S<Q.length;S++){P++;var L=Q[S];var R=T;T+=L;if(T&&S<Q.length-1){T+=" "}O.nodeValue=T;height=C.scrollHeight-M.top-M.bottom;if(S<10){}if(height>=u){O.nodeValue=R;z();O=document.createTextNode("");O.__originalNode=N;K.appendChild(O);T=""}if(P>200){break}}}function H(M){K.removeChild(M);var L=contentPadding;var S=M.nodeValue.split(" ");var V=0,U=0;var N="";var X;do{V++;if(V>100){console.log("!!!!!!!!!!!!! INFINITE LOOP A");break}var O=document.createTextNode("");O.__originalNode=M;K.appendChild(O);var Q=0;var T=S.length-1;X=T;var R=false;breakingWord="";do{U++;if(U>200){console.log("!!!!!!!!!!!! INFINITE LOOP B");break}var P=S.slice(0,X+1);var W=P.join(" ");O.nodeValue=W;height=C.scrollHeight-L.top-L.bottom;if(height>u){if(T-Q<=1){O.nodeValue=X>0?S.slice(0,X-1).join(" "):"";R=true;break}T=X}else{if(height<u){Q=X;if(X==T){break}if(T-Q<=1){O.nodeValue=S.slice(0,X-1).join(" ");R=true;break}}else{if(height==u){R=true;break}}}X=Q+Math.floor((T-Q)/2)}while(!R&&T>0);console.log("END LOOP B",X);if(R){S=S.slice(X+1);z()}else{break}}while(S.length>0)}function o(M){var L=(M<<0),L=L==M?L:L+1;return L}F.prototype.update=function(){console.time("PageWrap",this.content);var M=this.content.style.width;var N=this.content.style.height;var L=this.content.style.left;var O=this.content.style.top;var R=this.content.style.position;var P=this.content.style.overflow;this.content.style.width="auto";this.content.style.height="auto";this.content.style.overflow="visible";this.pages=[];if(this.originalItems){this.restore()}this.originalItems=m(this.content,true);C=this.content;K=null;E=null;n=0;v=[];var Q=A.getBorderMetrics(C,"padding");contentPadding=Q;I=this.pageWidth-Q.left-Q.right;u=this.pageHeight-Q.top-Q.bottom;u=u>F.MIN_PAGE_HEIGHT?u:F.MIN_PAGE_HEIGHT;console.log("****** PAGEWRAP EXECUTE: ",this.content,u,A.getHeight(C));B=null;t=[];z();y(this.content,0);p();console.log("PAGES: ",v);this.pages=v;this.content.style.width=M;this.content.style.height=N;this.content.style.left=L;this.content.style.top=O;this.content.style.position=R;this.content.style.overflow=P;console.timeEnd("PageWrap");return v};return F})();return h})();(function(){var a=benignware.core.Class;var h=a.require("benignware.core.Event");var d=a.require("benignware.util.StringUtils");var i=a.require("benignware.core.Component");var c=a.require("benignware.core.Element");var b=a.require("benignware.util.CSS");var g=a.require("benignware.layout.ItemLayout");var e=a.require("benignware.view.ScrollView");b.setDefaultStyle(".benignware-view-PageControl","position","relative");b.setDefaultStyle(".benignware-view-PageControl","text-align","center");b.setDefaultStyle(".benignware-view-PageControl .page-indicator","display","inline-block");b.setDefaultStyle(".benignware-view-PageControl .page-indicator","margin","10px 3px");b.setDefaultStyle(".benignware-view-PageControl .page-indicator","width","8px");b.setDefaultStyle(".benignware-view-PageControl .page-indicator","height","8px");b.setDefaultStyle(".benignware-view-PageControl .page-indicator","border-radius","4px");b.setDefaultStyle(".benignware-view-PageControl .page-indicator","background","#9a9a9a");b.setDefaultStyle(".benignware-view-PageControl .page-indicator.selected","background","#efefef");var f="ontouchstart" in window?"touchstart":"mousedown";return a("benignware.view.PageControl",(function(){var n;function k(){var o=n.apply(this,arguments);var w=this;var p=0;var q=1;var v;var u=false;var s=null;this.setPages=function(z){p=z;m.call(this)};this.getPages=function(){return p};this.setPage=function(z){if(z!=q){q=z;l.call(this)}};this.getPage=function(){return q};this.setSelectable=function(z){u=d.toBoolean(z);m.call(this)};this.isSelectable=function(){return u};function x(z){y.call(w,z.target)}function r(z){y.call(w,z.target)}function t(z){y.call(w,z.target)}function y(z){if(z.size){p=z.size();m.call(this)}if(z.getPage){q=z.getPage();l.call(this)}else{if(z.getPosition){q=z.getPosition()+1;l.call(this)}}}this.setView=function(z){z=typeof z=="string"?document.getElementById(z):z;console.log("set view",z);if(z!=s){if(s){z.removeEventListener("itemchange",x);z.removeEventListener("page",r);z.removeEventListener("position",t)}s=z;if(z!=null){z.addEventListener("itemchange",x);z.addEventListener("page",r);z.addEventListener("position",t);y.call(this,z)}}};this.getView=function(){return s};this.getPage=function(){return q}}a.extend(i,k);n=a.getParent(k);k.prototype.scrollView=null;k.prototype._initialize=function(){n._initialize.apply(this,arguments)};k.prototype._createChildren=function(){n._createChildren.apply(this,arguments)};k.prototype._update=function(){n._update.apply(this,arguments)};function l(){var q=this.getPage();for(var p=0;p<this.childNodes.length;p++){var o=this.childNodes[p];if(p==q-1){c.addCSSName(o,"selected")}else{c.removeCSSName(o,"selected")}}}function j(){var o=this.getView();if(o){var p=this.getPage();if(o.scrollToPage){o.scrollToPage(p)}else{if(o.setPage){o.setPage(p)}else{if(o.setPosition){o.setPosition(p-1)}}}}this.dispatchEvent(h.create(this.ownerDocument,"select",false,false))}function m(){var r=this;this.innerHTML="";var o=this.getPages();for(var q=0;q<o;q++){var p=this.ownerDocument.createElement("div");p.className="page-indicator";(function(){var t=q;p.addEventListener(f,function(u){if(r.isSelectable()){r.setPage(t+1);j.call(r)}},false)})();console.log("this.isSelectable(): ",this.isSelectable());p.style.cursor=this.isSelectable()?"pointer":"";this.appendChild(p)}var s=this.ownerDocument.createElement("div");s.style.clear="both";this.appendChild(s);l.call(this);this.invalidate()}return k})())})();(function(){var b=benignware.core.Class;var d=b.require("benignware.core.Element");var e=b.require("benignware.core.Container");var j=b.require("benignware.core.Event");var h=b.require("benignware.util.Delegate");var g=b.require("benignware.util.StringUtils");var c=b.require("benignware.util.CSS");var k=b.require("benignware.util.DOM");var i=b.require("benignware.layout.ItemLayout");var f;c.setDefaultStyle(".benignware-view-Lightbox","margin","30px");c.setDefaultStyle(".benignware-view-Lightbox","min-width","240px");c.setDefaultStyle(".benignware-view-Lightbox","max-width","420px");c.setDefaultStyle(".benignware-view-Lightbox","max-height","100%");c.setDefaultStyle(".benignware-view-Lightbox","z-index","10000");c.setDefaultStyle(".benignware-view-Lightbox","position","fixed");c.setDefaultStyle(".benignware-view-Lightbox","top","0");c.setDefaultStyle(".benignware-view-Lightbox","left","0");c.setDefaultStyle(".benignware-view-Lightbox.hidden","opacity","0");c.setDefaultStyle(".benignware-view-Lightbox","opacity","1");c.setDefaultStyle(".benignware-view-Lightbox","-moz-transition-property","opacity, visibility");c.setDefaultStyle(".benignware-view-Lightbox","-moz-transition-duration","0.15s");c.setDefaultStyle(".benignware-view-Lightbox","-moz-transition-timing-function","ease-in");c.setDefaultStyle(".benignware-view-Lightbox","-webkit-transition-property","opacity, visibility");c.setDefaultStyle(".benignware-view-Lightbox","-webkit-transition-duration","0.15s");c.setDefaultStyle(".benignware-view-Lightbox","-webkit-transition-timing-function","ease-in");c.setDefaultStyle(".benignware-view-Lightbox-background","position","fixed");c.setDefaultStyle(".benignware-view-Lightbox-background","top","0");c.setDefaultStyle(".benignware-view-Lightbox-background","left","0");c.setDefaultStyle(".benignware-view-Lightbox-background","width","100%");c.setDefaultStyle(".benignware-view-Lightbox-background","height","100%");c.setDefaultStyle(".benignware-view-Lightbox-background","background","#6e6e6e");c.setDefaultStyle(".benignware-view-Lightbox-background","opacity","0.8");c.setDefaultStyle(".benignware-view-Lightbox-background","z-index","10000");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-header","position","relative");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-header","background","#adadad");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-caption","display","block");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-caption","padding","5px");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-caption","position","relative");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-caption","float","left");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-close","background","url("+b.getPath("benignware.view.Lightbox","close.gif")+") no-repeat center");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-close","width","16px");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-close","height","16px");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-close","float","right");c.setDefaultStyle(".benignware-view-Lightbox .lightbox-close","cursor","pointer");c.setDefaultStyle(".benignware-view-Lightbox .content-layer","clear","both");c.setDefaultStyle(".benignware-view-Lightbox .content-layer","overflow","auto");c.setDefaultStyle(".benignware-view-Lightbox .content-layer","position","relative");c.setDefaultStyle(".benignware-view-Lightbox .content-layer","-webkit-overflow-scrolling","touch");c.setDefaultStyle(".benignware-view-Lightbox.maximized","margin","0");c.setDefaultStyle(".benignware-view-Lightbox.maximized","max-width","none");c.setDefaultStyle(".benignware-view-Lightbox.maximized","max-height","none");c.setDefaultStyle(".benignware-view-Lightbox.maximized","width","100%");c.setDefaultStyle(".benignware-view-Lightbox.maximized","height","100%");c.setDefaultStyle(".benignware-view-Lightbox.maximized .content-layer","height","100%");function a(){f.apply(this,arguments);var o=this;var q="ontouchstart" in window?"touchstart":"mousedown";var l="ontouchend" in window?"touchend":"click";function n(s){console.log("show handler");d.addEventListener(o.ownerDocument,q,m,false);o.addEventListener("hide",p,false)}function p(s){console.log("hide handler");d.removeEventListener(o.ownerDocument,q,m,false)}function m(s){var t=s.target||s.srcElement;console.log("down handler",t);d.addEventListener(o.ownerDocument,l,r,false)}function r(s){d.removeEventListener(o.ownerDocument,l,r,false);var t=s.target||s.srcElement;if(t!=o&&!k.isChildOf(t,o)){o.hide();var u=d.getComputedStyle(o.backgroundElem,"display");if(u!="none"){var t=s.target||s.srcElement;if(t.nodeName.toLowerCase()=="a"&&t.getAttribute("href")){s.preventDefault();s.stopPropagation()}return false}}}this.addEventListener("show",n,false)}b.register("benignware.view.Lightbox",a);b.extend(e,a);f=b.getParent(a);a.prototype.backgroundElem=null;a.prototype.headerElem=null;a.prototype.captionElem=null;a.prototype.closeElem=null;a.prototype.originalParentElem=null;a.prototype._initialize=function(l){f._initialize.apply(this,arguments)};a.prototype._createChildren=function(){f._createChildren.apply(this,arguments);var m=this.ownerDocument.createElement("div");m.className="benignware-view-Lightbox-background";this.insertBefore(m,this.contentElem);this.backgroundElem=m;var l=this.ownerDocument.createElement("div");l.className="lightbox-header";this.insertBefore(l,this.contentElem);this.headerElem=l;var n=this.ownerDocument.createElement("div");n.className="lightbox-caption";this.headerElem.appendChild(n);this.captionElem=n;var o=this.ownerDocument.createElement("div");var p="ontouchstart" in window?"touchstart":"mousedown";d.addEventListener(o,p,h.create(this,function(r){this.hide();r.preventDefault()}),false);o.className="lightbox-close";this.headerElem.appendChild(o);this.closeElem=o;var q=this.ownerDocument.createElement("div");q.style.clear="both";this.headerElem.appendChild(q);console.log("initial hide");this.hide()};a.prototype._update=function(){var z=d.getDocumentSize(this.ownerDocument);d.setSize(this.backgroundElem,z.width,z.height);this.backgroundElem.style.display="none";var l=this.offsetParent||document.body;var s=d.getBorderMetrics(this,"border","margin");var n=this.contentElem.style.height;this.contentElem.style.height="auto";var v=d.getOuterHeight(this.contentElem);var o=d.getOuterHeight(this.headerElem);if(z.height<v+o+s.top+s.bottom){d.setOuterHeight(this.contentElem,z.height-o-s.top-s.bottom)}else{this.contentElem.style.height=n}var q=this.style.width;this.style.width="";var m=d.getOuterWidth(this);var u=d.getOuterWidth(this);var p=d.getOuterHeight(this);var t=s.left+(z.width-u-s.right-s.left)*0.5;var r=s.top+(z.height-p-s.bottom-s.top)*0.5;t=t<0?0:t;r=r<0?0:r;this.style.left=t+"px";this.style.top=r+"px";this.backgroundElem.style.display="";console.log("update lightbox")};a.prototype.setCaption=function(l){this.captionElem.innerHTML=l};a.prototype.getCaption=function(){return this.captionElem.innerHTML};a.prototype.setMaximized=function(l){if(l){this.addCSSName("maximized")}else{this.removeCSSName("maximized")}this.invalidate()};a.prototype.getMaximized=function(){return d.hasCSSName(this,"maximized")};a.prototype.show=function(){console.log("show lightbox");this.originalParentElem=this.parentNode;this.ownerDocument.body.appendChild(this);this.ownerDocument.body.insertBefore(this.backgroundElem,this);f.show.apply(this,arguments)};a.prototype.hide=function(){console.log("hide lightbox");if(this.originalParentElem){this.originalParentElem.appendChild(this)}this.insertBefore(this.backgroundElem,this.headerElem);f.hide.apply(this,arguments)};return a})();